{"version":3,"file":"src_app_pages_my-travels_details-trip-request_details-trip-request_module_ts.js","mappings":"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","sources":["./src/app/pages/my-travels/details-trip-request/details-trip-request-routing.module.ts","./src/app/pages/my-travels/details-trip-request/details-trip-request.module.ts","./src/app/pages/my-travels/details-trip-request/details-trip-request.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { DetailsTripRequestPage } from './details-trip-request.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: DetailsTripRequestPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class DetailsTripRequestPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { DetailsTripRequestPageRoutingModule } from './details-trip-request-routing.module';\r\n\r\nimport { DetailsTripRequestPage } from './details-trip-request.page';\r\nimport { CmxWebComponentsModule } from '@cmx-web-components/angular';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    CmxWebComponentsModule.forRoot(),\r\n    DetailsTripRequestPageRoutingModule\r\n  ],\r\n  declarations: [DetailsTripRequestPage]\r\n})\r\nexport class DetailsTripRequestPageModule {}\r\n","import { Location } from '@angular/common';\r\nimport { TravelService } from './../../../services/travels/travel.service';\r\nimport { Travel } from './../../../interfaces/travels/travel';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { UserService } from '../../../services/user.service';\r\nimport { VehiclesService } from '../../../services/vehicles.service';\r\nimport { DriverList } from '../../drivers/models/drivers-list';\r\nimport { DriversService } from '../../../services/drivers.service';\r\nimport { Subscription } from 'rxjs';\r\nimport { LoginService } from '../../../services/auth/login.service';\r\n\r\n@Component({\r\n  selector: 'app-details-trip-request',\r\n  templateUrl: './details-trip-request.page.html',\r\n  styleUrls: ['./details-trip-request.page.scss'],\r\n})\r\nexport class DetailsTripRequestPage implements OnInit {\r\n\r\n  id: string;\r\n  travel = new Travel();\r\n\r\n  listDrivers : DriverList[] = [];\r\n  driveSelected : string = 'Seleccionar';\r\n  driverId : string;\r\n  licenseOk : boolean = true;\r\n\r\n  messageShowA : boolean = false;\r\n  messageShow : boolean = false;\r\n\r\n  suscripcion: Subscription;\r\n\r\n  constructor(private location : Location,\r\n    private travelService: TravelService,\r\n    private userService : UserService,\r\n    private vehiclesService : VehiclesService,\r\n    private driversService : DriversService,\r\n    private loginService : LoginService\r\n    ) { }\r\n\r\n  ngOnInit() {\r\n    this.suscripcion = this.travelService.refresh$.subscribe(() => {\r\n      this.getData();\r\n      this.getListDrivers();\r\n    });\r\n    this.getData();\r\n    this.getListDrivers();\r\n  }\r\n\r\n  onBack(){\r\n    this.location.back();\r\n  }\r\n\r\n  getListDrivers(){\r\n    this.driversService.getDriverList(this.loginService.profileUser.CompanyId).subscribe(data => {\r\n      this.listDrivers = data.data;\r\n    });\r\n  }\r\n\r\n  getData() {\r\n    if (this.travelService.id !== null) {\r\n      this.id = this.travelService.id;\r\n      this.travelService.getTravelDetail(this.id).subscribe(data => {\r\n        this.travel = data.data;\r\n      });\r\n    }\r\n  }\r\n\r\n  showModal(){    \r\n    document.getElementById('modal-assign-trip').setAttribute('open', 'true');\r\n  }\r\n\r\n  showModalConfirm(){\r\n    const dataD = new FormData();\r\n    dataD.append('StatusTravel', '4');\r\n    dataD.append('StatusTravelAvailability', '4');\r\n    dataD.append('id', this.travel.id);\r\n    this.driversService.confirmDrive(this.travel.id, dataD).subscribe(()=>{      \r\n      document.getElementById('modal-confirm-driver').setAttribute('open', 'true');\r\n    },(err)=>{\r\n      this.onBack();\r\n      console.log(err);\r\n    });\r\n  }\r\n\r\n\r\n  changeDriver(event){\r\n    if(event.detail.value === '0'){\r\n      this.driveSelected = 'Seleccionar';\r\n      this.licenseOk = true;\r\n    }else{\r\n      this.driverId = event.detail.value;\r\n      this.userService.getUserDetail(event.detail.value).subscribe(data=>{\r\n        this.vehiclesService.getVehicleById(data.data.lisenseVehicle).subscribe(dataV=>{\r\n          this.driveSelected = dataV.data.licenseVehiculo;\r\n          this.licenseOk = false;\r\n        })\r\n      });\r\n    }\r\n  }\r\n\r\n  driverAssign(){\r\n    const dataD = new FormData();\r\n    dataD.append('Id', this.travel.id);\r\n    dataD.append('UserId', this.driverId);\r\n\r\n    const data = new FormData();\r\n    data.append('StatusTravel', '3');\r\n    data.append('StatusTravelAvailability', '3');\r\n    data.append('id', this.travel.id);\r\n    this.travelService.updateTravel(this.travel.id, dataD).subscribe(()=>{        \r\n      this.driversService.confirmDrive(this.travel.id, data).subscribe(()=>{\r\n        document.getElementById('modal-assign-trip').setAttribute('open', 'false');\r\n        this.messageShowA = true;\r\n      },(err)=>{\r\n        document.getElementById('modal-assign-trip').setAttribute('open', 'false');\r\n        this.onBack();\r\n        console.log(err);\r\n      });\r\n    },(err)=>{\r\n      document.getElementById('modal-assign-trip').setAttribute('open', 'false');\r\n      console.log(err);\r\n    });\r\n  }\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}